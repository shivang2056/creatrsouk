<%= form_with(model: [@user_purchase, review]) do |form| %>
  <%= form.label :rating, 'Liked it? Give it a rating:', class: "text-sm text-gray-700" %>

  <div class="mt-2 mb-4 flex gap-0.5" data-controller="rating">
    <%= form.hidden_field :rating, data: { rating_target: "input" } %>

    <% if review.rating.to_i > 0 %>
      <% review.rating.times do |i| %>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 fill-gray-700" data-rating="<%= i + 1 %>" data-rating-target="star" data-action="click->rating#setRating">
          <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z" data-rating="<%= i + 1 %>" />
        </svg>
      <% end %>

      <% (5 - review.rating).times do |i| %>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5" data-rating="<%= i + review.rating + 1 %>" data-rating-target="star" data-action="click->rating#setRating">
          <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z" data-rating="<%= i + review.rating + 1 %>" />
        </svg>
      <% end %>
    <% else %>
      <% 5.times do |i| %>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5" data-rating="<%= i + 1 %>" data-rating-target="star" data-action="click->rating#setRating">
          <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z" data-rating="<%= i + 1 %>" />
        </svg>
      <% end %>
    <% end %>
  </div>

  <%= form.text_area :comment, placeholder: "Add a written review", class: "block w-full px-3 py-2 mt-2 border rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-gray-500 focus:border-gray-500 text-sm h-full border-gray-300", rows: 6 %>

  <div class="pt-4">
    <%= form.submit submit_label, class: "w-full text-sm duration-200 border font-medium focus:outline-none focus:ring-2 inline-flex items-center whitespace-nowrap bg-white hover:bg-gray-300 text-gray-900 justify-center rounded-md shadow-sm border-gray-700 py-2 px-4", data: {turbo_frame: '_top'} %>
  </div>
<% end %>
